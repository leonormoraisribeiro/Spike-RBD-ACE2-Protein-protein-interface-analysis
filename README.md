# Spike-RBD-ACE2-Protein-protein-interface-analysis

**Project:** Bio-Physics Exercise 2025-26

**Objective:** To evaluate the relative contribution of interface residues to the interaction energy in the RBD-ACE2 protein-protein complex using the structure **6m0j**.

---

##  Repository Structure

```text
├── data/
│   ├── 6m0j_fixed.pdb       # Cleaned structure (no heteroatoms, H added)
│   ├── 6m0j_fixed.pdbqt     # Structure with partial charges and atom types
│   ├── *.asa                # Atomic solvent accessibility (for Energy calc)
│   └── *.rsa                # Residue solvent accessibility (for Analysis)
├── scripts/
│   ├── structure_setup.py   # Setup pipeline using biobb
│   ├── interface_analysis.py # Interface detection (Distance & ASA)
│   └── energy_calculation.py # (In progress)
├── README.md
└── requirements.txt
```

## Step 1: Structure Preparation & Interface Definition

**Objective:** To prepare the biological system for simulation and identify the amino acid residues forming the protein-protein interface between SARS-CoV-2 RBD and ACE2.

### 1.1 Structure Setup (BioBB)
The raw structure **6m0j** was processed to fix experimental artifacts and prepare it for energy calculations.

* **Tool:** `biobb_structure_checking`.
* **Workflow:**
    1.  **Chain Selection:** Isolated chains **E** (RBD) and **A** (ACE2).
    2.  **Cleaning:** Removed crystallographic waters and heteroatoms.
    3.  **Fixing:** Added missing side-chain atoms and hydrogens.
    4.  **Charges:** Added partial charges and atom types, generating a **PDBQT** file for electrostatic calculations.
* **Key Outputs:**
    * `6m0j_fixed.pdb` (Clean PDB)
    * `6m0j_fixed.pdbqt` (PDB with charges/atom types)

### 1.2 Solvent Accessibility (NACCESS)
To evaluate solvation effects, we calculated the Accessible Surface Area (ASA).

* **Calculation:** Performed on the bound complex (`A+E`) and unbound components (`A` and `E` isolated).
* **Outputs:**
    * `.rsa` files: Residue-level data (used for quick visual analysis).
    * `.asa` files: Atomic-level data (used for $\Delta G_{solv}$ calculation).

### 1.3 Defining the Interface
We implemented two complementary methods to define the interface residues:

1.  **Distance Criterion (Geometric):**
    * Residues are considered part of the interface if any of their atoms are within a cut-off distance (e.g., 5Å) of an atom in the opposing chain.
    * *Implementation:* Python script using `interface_distance.py`.

2.  **Solvation Criterion (△ASA):**
    * Residues are defined as interface if they lose solvent accessibility upon complex formation.
    * $\Delta ASA = ASA_{unbound} - ASA_{bound} > \text{cutoff}$
    * *Implementation:* Python script using `interface_asa_variation.py`.

3. **Create a Pymol Visualization of the Interface**
    * With the residues calculated with the △ASA, a python script was created to visualize in python the residues selected
    * *Implementation:* Python script using `create_interface_pymol.py`.


## Step 2: Interaction Energy Calculation

**Objective:** To calculate the total interaction energy ($\Delta G_{binding}$) between the RBD and ACE2 interface residues, assuming a rigid-body approximation (no conformational changes upon binding).

### 2.1 Methodology
The interaction energy was calculated as the sum of three components using custom Python scripts:
$$\Delta G^{A-B} = \Delta G_{vdw} + \Delta G_{elec} + \Delta G_{solv}$$

1.  **Solvation Energy ($\Delta G_{solv}$):**
    * Calculated based on the change in Solvent Accessible Surface Area (ASA) per atom type.
    * $\Delta G_{solv} = \sum \sigma_i (ASA_{complex} - ASA_{free})$
    * Parameters ($\sigma_i$) derived from `vdwprm` file.
    * **Input:** Atomic ASA files (`.asa`) generated by NACCESS.

2.  **Van der Waals Interaction ($\Delta G_{vdw}$):**
    * Modeled using a standard Lennard-Jones 6-12 potential.
    * Parameters ($\epsilon, \sigma$) obtained from the project forcefield.

3.  **Electrostatic Interaction ($\Delta G_{elec}$):**
    * Calculated using Coulomb's law with the **Mehler-Solmajer** distance-dependent dielectric function to simulate solvent screening.
    * **Charges:** Partial charges were successfully generated using `biobb_structure_checking` (AutoDock Tools / Gasteiger method) and read from the corrected `6m0j_fixed.pdbqt` file.

### 2.2 Implementation Details
* **Script:** `step2_final_calculation.py`
* **Interface Definition:** The calculation was restricted to interface residues defined by a change in ASA > 0.01 $Å^2$ (Total: 52 residues).
* **Charge Correction:** The PDBQT generation pipeline was corrected to ensure partial charges were properly written to the file, avoiding the need for manual charge injection.

### 2.3 Results
The energy calculation for the 52 residues at the interface yielded the following values:

| Energy Component | Value (kcal/mol) | Interpretation |
| :--- | :--- | :--- |
| **Van der Waals** | **-66.23** | Dominant term. Indicates high **shape complementarity** (steric fit) between RBD and ACE2. |
| **Electrostatics** | **-1.61** | Favorable (attractive) contribution, suggesting specific salt bridges or H-bonds stabilizing the complex. |
| **Solvation** | **-4.11** | Favorable. Suggests a strong **hydrophobic effect**, where non-polar residues are buried upon binding. |
| **TOTAL ($\Delta G$)**| **-71.95** | **Highly stable complex.** |

---
