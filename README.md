# Spike-RBD-ACE2-Protein-protein-interface-analysis

**Project:** Bio-Physics Exercise

**Objective:** To evaluate the relative contribution of interface residues to the interaction energy in the RBD-ACE2 protein-protein complex using the structure **6m0j**.

---

##  Repository Structure

```text
├── data/
│   ├── 6m0j_fixed.pdb       # Cleaned structure (no heteroatoms, H added)
│   ├── 6m0j_fixed.pdbqt     # Structure with partial charges and atom types
│   ├── *.asa                # Atomic solvent accessibility (for Energy calc)
│   └── *.rsa                # Residue solvent accessibility (for Analysis)
├── Python Scripts/
│   ├── structure_setup.py   # Setup pipeline using biobb
│   ├── interface_analysis.py # Interface detection (Distance & ASA)
│   └── energy_calculation.py
├── Python Scripts/
│   ├── alanine_scan_results.csv
│   ├── alanine_scanning_plot.png # plot made for Step3
│   ├── hotspot.png
│   ├── interface.png
│   ├── visualize_comparison.pml
│   ├── visualize_distance_interface.pml
│   ├── visualize_hotspots.pml
│   └── visualize_interface_asa_variation.pml
├── README.md
└── Energy analysis Project.pdf # instruction of the project
```

## Step 1: Structure Preparation & Interface Definition

**Objective:** To prepare the biological system for simulation and identify the amino acid residues forming the protein-protein interface between SARS-CoV-2 RBD and ACE2.

### 1.1 Structure Setup (BioBB)
The raw structure **6m0j** was processed to fix experimental artifacts and prepare it for energy calculations.

* **Tool:** `biobb_structure_checking`.
* **Workflow:**
    1.  **Chain Selection:** Isolated chains **E** (RBD) and **A** (ACE2).
    2.  **Cleaning:** Removed crystallographic waters and heteroatoms.
    3.  **Fixing:** Added missing side-chain atoms and hydrogens.
    4.  **Charges:** Added partial charges and atom types, generating a **PDBQT** file for electrostatic calculations.
* **Key Outputs:**
    * `6m0j_fixed.pdb` (Clean PDB)
    * `6m0j_fixed.pdbqt` (PDB with charges/atom types)

### 1.2 Solvent Accessibility (NACCESS)
To evaluate solvation effects, we calculated the Accessible Surface Area (ASA).

* **Calculation:** Performed on the bound complex (`A+E`) and unbound components (`A` and `E` isolated).
* **Outputs:**
    * `.rsa` files: Residue-level data (used for quick visual analysis).
    * `.asa` files: Atomic-level data (used for $\Delta G_{solv}$ calculation).

### 1.3 Defining the Interface
We implemented two complementary methods to define the interface residues:

1.  **Distance Criterion (Geometric):**
    * Residues are considered part of the interface if any of their atoms are within a cut-off distance (e.g., 5Å) of an atom in the opposing chain.
    * *Implementation:* Python script using `interface_distance.py`.

2.  **Solvation Criterion (△ASA):**
    * Residues are defined as interface if they lose solvent accessibility upon complex formation.
    * $\Delta ASA = ASA_{unbound} - ASA_{bound} > \text{cutoff}$
    * *Implementation:* Python script using `interface_asa_variation.py`.

3. **Create a Pymol Visualization of the Interface**
    * With the residues calculated with the △ASA, a python script was created to visualize in python the residues selected
    * *Implementation:* Python script using `create_interface_pymol.py`.

### 1.4 Interface Definition Comparison
To validate the accuracy of our interface definition, we developed a script to statistically compare the **Geometric** approach (Distance < 8.0Å) against the **Thermodynamic** approach ($\Delta$ASA > 0.01 $\mathring{A}^2$).

* **Script:** `compare_interfaces.py`
* **Method:** Calculated the set intersection and the **Jaccard Index** ($J = \frac{|A \cap B|}{|A \cup B|}$) to quantify the overlap between the two criteria.

**Key Results:**
* **Geometric Interface (Distance):** 112 residues.
* **Thermodynamic Interface (Energy):** 52 residues.
* **Intersection:** 52 residues.
* **Jaccard Index:** 0.4643.
---

## Step 2: Interaction Energy Calculation

**Objective:** To calculate the total interaction energy ($\Delta G_{binding}$) between the RBD and ACE2 interface residues, assuming a rigid-body approximation (no conformational changes upon binding).

### 2.1 Methodology
The interaction energy was calculated as the sum of three components using custom Python scripts:
$$\Delta G^{A-B} = \Delta G_{vdw} + \Delta G_{elec} + \Delta G_{solv}$$

1.  **Solvation Energy ($\Delta G_{solv}$):**
    * Calculated based on the change in Solvent Accessible Surface Area (ASA) per atom type.
    * $\Delta G_{solv} = \sum \sigma_i (ASA_{complex} - ASA_{free})$
    * Parameters ($\sigma_i$) derived from `vdwprm` file.
    * **Input:** Atomic ASA files (`.asa`) generated by NACCESS.

2.  **Van der Waals Interaction ($\Delta G_{vdw}$):**
    * Modeled using a standard Lennard-Jones 6-12 potential.
    * Parameters ($\epsilon, \sigma$) obtained from the project forcefield.

3.  **Electrostatic Interaction ($\Delta G_{elec}$):**
    * Calculated using Coulomb's law with the **Mehler-Solmajer** distance-dependent dielectric function to simulate solvent screening.
    * **Charges:** Partial charges were successfully generated using `biobb_structure_checking` (AutoDock Tools / Gasteiger method) and read from the corrected `6m0j_fixed.pdbqt` file.

### 2.2 Implementation Details
* **Script:** `interaction_energy.py`
* **Interface Definition:** The calculation was restricted to interface residues defined by a change in ASA > 0.01 $Å^2$ (Total: 52 residues).
* **Charge Correction:** The PDBQT generation pipeline was corrected to ensure partial charges were properly written to the file, avoiding the need for manual charge injection.

### 2.3 Results
The energy calculation for the 52 residues at the interface yielded the following values:

| Energy Component | Value (kcal/mol) | Interpretation |
| :--- | :--- | :--- |
| **Van der Waals** | **-66.23** | Dominant term. Indicates high **shape complementarity** (steric fit) between RBD and ACE2. |
| **Electrostatics** | **-1.61** | Favorable (attractive) contribution, suggesting specific salt bridges or H-bonds stabilizing the complex. |
| **Solvation** | **-4.11** | Favorable. Suggests a strong **hydrophobic effect**, where non-polar residues are buried upon binding. |
| **TOTAL ($\Delta G$)**| **-71.95** | **Highly stable complex.** |

---

## Step 3: In-Silico Alanine Scanning & Hotspot Analysis

**Objective:** To determine the individual contribution of each interface residue to the complex stability by mimicking a traditional Alanine Scanning experiment computationally.

### 3.1 Methodology
Instead of generating 50+ individual PDB mutant structures, we implemented a **virtual mutation algorithm** ("On-the-fly" atom masking):

1.  **Rigid Body Approximation:** The backbone and remaining atoms are assumed to stay fixed (no relaxation).
2.  **Virtual Mutation:** For the target residue, the energy calculation loop ignores all atoms except those shared with Alanine (N, C, O, CA, CB).
3.  **$\Delta\Delta G$ Calculation:**
    * $\Delta\Delta G = \Delta G_{mutant} - \Delta G_{WT}$
    * **Positive $\Delta\Delta G$:** Indicates the mutation destabilizes the complex (the residue was important).
    * **Hotspot Definition:** Residues with $\Delta\Delta G > 1.0$ kcal/mol.

### 3.2 Implementation Pipeline
We developed a unified pipeline to perform calculation, data export, and plotting.

* **Input:** `interface_data.py` (List of interface residues generated in Step 1).
* **Core Script:** `alanine_scanning.py`
    * Imports energy functions from `interaction_energy.py`.
    * Iterates through all interface residues.
    * Computes $\Delta G$ for the "virtual mutant".
    * Exports results to CSV and generates a ranked bar plot.
* **Visualization Script:** `pymol_visualization_hotspots.py`
    * Automatically generates a PyMOL script (`.pml`) to highlight identified hotspots.

### 3.3 Key Results
The analysis identified specific "Hotspots" that are critical for the RBD-ACE2 interaction.

* **Top Hotspots Identified:**
    * **Phe486 (Chain E):** The most critical residue ($\Delta\Delta G \approx 14.8$ kcal/mol). Acts as a hydrophobic anchor penetrating the ACE2 surface.
    * **Tyr505 (Chain E):** Provides significant stability through H-bonds and Van der Waals interactions.
    * **Aromatic Dominance:** The top contributors (Phe, Tyr) rely heavily on ring stacking interactions.
* **Magnitude Note:** The high absolute values (>10 kcal/mol) are a result of the rigid-body assumption (lack of structural relaxation and water solvation), but the **relative ranking** is biologically consistent with structural data.

### 3.4 Files & Outputs

| File | Description |
| :--- | :--- |
| `alanine_scanning_results.csv` | Table containing computed energies and $\Delta\Delta G$ for all 52 residues. |
| `alanine_scanning_plot.png` |  Bar chart ranking residues by stability contribution. Red bars indicate hotspots. |
| `visualize_hotspots.pml` |  PyMOL script to visualize Phe486/Tyr505 anchoring into ACE2. |

---

# Step 5 – Modeling Real SARS-CoV-2 Variants

This step aims to evaluate the energetic effect of **real SARS-CoV-2 Spike RBD mutations** (Alpha, Beta, Delta variants) on the interaction with the ACE2 receptor. The analysis follows the same energy pipeline used in previous steps, but replacing alanine mutations with biologically relevant substitutions.

## 5.1 Starting Structure

All mutations were generated from the wild-type Spike–ACE2 complex:

```         
6m0j_fixed.pdb
```

------------------------------------------------------------------------

## 5.2 Selecting a Specific Residue in PyMOL (IMPORTANT)

To avoid mistakes, residues are selected **explicitly by chain and residue number** using PyMOL commands

### Load the structure

``` pymol
delete all
load 6m0j_fixed.pdb
```

### Highlight the RBD chain (chain E)

``` pymol
show cartoon
color gray
color orange, chain E
```

![](images/clipboard-3248303220.png){width="374"}

### Select the target residue (example: E484 in chain E)

``` pymol
select target_res, chain E and resi 484
show sticks, target_res
zoom target_res, 5
```

At this point, only the selected residue should appear in stick representation.

![](images/clipboard-902392593.png){width="256"}

Examples of commonly used mutations:

``` pymol
# N501Y (Alpha / Beta)
select target_res, chain E and resi 501

# E484K (Beta)
select target_res, chain E and resi 484

# L452R (Delta)
select target_res, chain E and resi 452
```

------------------------------------------------------------------------

## 5.3 Generating the Mutation with PyMOL

### Activate the mutagenesis wizard

``` pymol
wizard mutagenesis
```

-   Click directly on the residue shown in sticks.

-   In the wizard panel, choose the new amino acid.

-   Activate **Backbone Dependent Rotamers**.

-   Browse rotamers and select the one with minimal steric clashes.

-   Click **Apply** to confirm the mutation.

### Save the mutated complex

```         
wizard off
save mut_<MUTATION>_complex.pdb
```

AFTER the mutated complex:

![](images/clipboard-4189905293.png){width="256"}

And now it's time to repeat until get the examples:

```         
mut_N501Y_complex.pdb
mut_E484K_complex.pdb
mut_L452R_complex.pdb
```

``` pymol
delete all
load 6m0j_fixed.pdb
...
...
```

## 5.4 Splitting ACE2 and RBD Chains

The mutated complex is split into ACE2 and RBD components:

``` pymol
select ACE2, chain A
save mut_<MUTATION>_A.pdb, ACE2

select RBD, chain E
save mut_<MUTATION>_B.pdb, RBD
```

Generated files:

```         
mut_<MUTATION>_A.pdb
mut_<MUTATION>_B.pdb
```

## 5.5 Structure Preparation with `check_structure`

PyMOL only rotates side chains and does **not** fix hydrogens or assign proper charges.
Therefore, **biobb_structure_checking** must be used before energy calculations.

Generate PDBQT with correct hydrogens and ADT charges

``` bash
check_structure \
  -i mut_<MUTATION>_complex.pdb \
  -o mut_<MUTATION>_complex.pdbqt \
  add_hydrogen \
  --add_charges ADT \
  --add_mode auto
```

This step ensures:

-   Correct hydrogen placement

-   Proper AutoDock-compatible charges

-   Consistency with the energy calculation scripts

```         
...
...
Structure saved on mut_N501Y_complex.pdbqt
```

And now repeat the same for the other ones.

------------------------------------------------------------------------

## 5.6 Solvent Accessible Surface Area (NACCESS)

Solvent accessibility is recalculated for each mutated system:

``` bash
./naccess mut_<MUTATION>_complex.pdb
./naccess mut_<MUTATION>_A.pdb
./naccess mut_<MUTATION>_B.pdb
```

Generated files:

``` bash
mut_<MUTATION>_complex.asa
mut_<MUTATION>_A.asa
mut_<MUTATION>_B.asa
```

## 5.7 Interaction Energy Calculation

The interaction energy is computed using the provided Python function:

``` python
compute_interaction_energy()
```

A dedicated script is used for each mutation (provided in the folder), for example:

```         
step5_N501Y_energy.py
step5_E484K_energy.py
step5_L452R_energy.py
```

Each script:

1.  Computes wild-type interaction energy

2.  Computes mutant interaction energy

3.  Calculates ΔΔG = ΔG_mut − ΔG_WT

Example execution:

``` bash
$ python3 step5_N501Y_energy.py
Output:
'''
Calculating WT interaction energy...
WT ΔG = -71.152 kcal/mol

Calculating N501Y mutant interaction energy...
N501Y ΔG = -65.788 kcal/mol

==============================
ΔΔG (N501Y) = 5.364 kcal/mol
==============================
'''


$ python step5_E484K_energy.py 
Output:
'''
Calculating WT interaction energy...
WT ΔG = -71.152 kcal/mol

Calculating E484K mutant interaction energy...
E484K ΔG = -75.898 kcal/mol

==============================
ΔΔG (E484K) = -4.745 kcal/mol
==============================
'''

$ python step5_L452R_energy.py 
Output:
'''
Calculating WT interaction energy...
WT ΔG = -71.152 kcal/mol

Calculating L452R mutant interaction energy...
L452R ΔG = -69.808 kcal/mol

==============================
ΔΔG (L452R) = 1.345 kcal/mol
==============================
'''
```

## Summary

Among the analyzed variants, **E484K** emerged as the most relevant mutation, as it showed a clearly stabilizing effect on the complex (ΔΔG = −4.745 kcal/mol). This indicates a stronger interaction compared to the wild-type structure and highlights the importance of electrostatic contributions at the binding interface.

In contrast, **L452R** exhibited only a mild destabilizing effect, suggesting a limited influence on binding affinity within the scope of this model. The **N501Y** mutation resulted in a destabilizing ΔΔG, which contrasts with experimental observations and reflects the limitations of a simplified, static energy approach that does not capture conformational flexibility.

Overall, these results suggest that **E484K is the most energetically impactful mutation** in this analysis, emphasizing how specific substitutions can dominate interaction energetics.
